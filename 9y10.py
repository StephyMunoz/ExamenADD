{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "advisory-western",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from pymongo import MongoClient\n",
    "import csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "occasional-flesh",
   "metadata": {},
   "outputs": [],
   "source": [
    "client = pymongo.MongoClient(\"mongodb+srv://esfot:esfot@cluster0.845nq.mongodb.net/animalsandRecycling?retryWrites=true&w=majority\")\n",
    "try:\n",
    "    client.admin.command('ismaster')\n",
    "    print('MongoDB Atlas connection: Success')\n",
    "except ConnectionFailure as e:\n",
    "    print('MongoDB Atlas connection: failed', e)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "surgical-shaft",
   "metadata": {},
   "outputs": [],
   "source": [
    "db = client.get_database('elecciones_2021')\n",
    "collection = db.get_collection('eleccionesgenerales2021')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "practical-investigator",
   "metadata": {},
   "outputs": [],
   "source": [
    "dfMA = pd.DataFrame(list(collection.find()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "dynamic-pleasure",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>_id</th>\n",
       "      <th>_rev</th>\n",
       "      <th>created_at</th>\n",
       "      <th>id</th>\n",
       "      <th>id_str</th>\n",
       "      <th>text</th>\n",
       "      <th>source</th>\n",
       "      <th>truncated</th>\n",
       "      <th>in_reply_to_status_id</th>\n",
       "      <th>in_reply_to_status_id_str</th>\n",
       "      <th>...</th>\n",
       "      <th>lang</th>\n",
       "      <th>timestamp_ms</th>\n",
       "      <th>extended_tweet</th>\n",
       "      <th>possibly_sensitive</th>\n",
       "      <th>display_text_range</th>\n",
       "      <th>quoted_status_id</th>\n",
       "      <th>quoted_status_id_str</th>\n",
       "      <th>quoted_status</th>\n",
       "      <th>quoted_status_permalink</th>\n",
       "      <th>extended_entities</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1351290781533876227</td>\n",
       "      <td>1-4138829b6443900e6e78db8e50b85706</td>\n",
       "      <td>Mon Jan 18 22:10:02 +0000 2021</td>\n",
       "      <td>1351290781533876227</td>\n",
       "      <td>1351290781533876227</td>\n",
       "      <td>RT @sybelmartinez: 13 niñas menores de 14 años...</td>\n",
       "      <td>&lt;a href=\"http://twitter.com/download/android\" ...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611007802743</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1351290783903563777</td>\n",
       "      <td>1-c18c818a1189d2f834793b13d31404df</td>\n",
       "      <td>Mon Jan 18 22:10:03 +0000 2021</td>\n",
       "      <td>1351290783903563777</td>\n",
       "      <td>1351290783903563777</td>\n",
       "      <td>RT @emersoncruuz: @cony_ruiz32 @luisevivanco E...</td>\n",
       "      <td>&lt;a href=\"http://ecuabot.org\" rel=\"nofollow\"&gt;Ec...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611007803308</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1351290784562225155</td>\n",
       "      <td>1-e67050c0001bf1a89559b88168ce4074</td>\n",
       "      <td>Mon Jan 18 22:10:03 +0000 2021</td>\n",
       "      <td>1351290784562225155</td>\n",
       "      <td>1351290784562225155</td>\n",
       "      <td>#Migración | Te contamos la historia de José A...</td>\n",
       "      <td>&lt;a href=\"https://www.hootsuite.com\" rel=\"nofol...</td>\n",
       "      <td>True</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611007803465</td>\n",
       "      <td>{'full_text': '#Migración | Te contamos la his...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1351290788777349120</td>\n",
       "      <td>1-60e88d1a7759b584e8296ee13a8d2e8e</td>\n",
       "      <td>Mon Jan 18 22:10:04 +0000 2021</td>\n",
       "      <td>1351290788777349120</td>\n",
       "      <td>1351290788777349120</td>\n",
       "      <td>@Danilosaavedr1 @FaustoCoboM3 Según él, todo l...</td>\n",
       "      <td>&lt;a href=\"https://about.twitter.com/products/tw...</td>\n",
       "      <td>True</td>\n",
       "      <td>1.351274e+18</td>\n",
       "      <td>1351273597076049920</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611007804470</td>\n",
       "      <td>{'full_text': '@Danilosaavedr1 @FaustoCoboM3 S...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[30, 140]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1351290803306508293</td>\n",
       "      <td>1-098a860688d58a118589ff6c6f1a7a7c</td>\n",
       "      <td>Mon Jan 18 22:10:07 +0000 2021</td>\n",
       "      <td>1351290803306508293</td>\n",
       "      <td>1351290803306508293</td>\n",
       "      <td>RT @FerminVallejos1: Victoria de la patria gra...</td>\n",
       "      <td>&lt;a href=\"http://twitter.com/download/android\" ...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611007807934</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>145</th>\n",
       "      <td>1351291779102990338</td>\n",
       "      <td>1-d55070debfe85acb5d4eb036ea7cf4a1</td>\n",
       "      <td>Mon Jan 18 22:14:00 +0000 2021</td>\n",
       "      <td>1351291779102990338</td>\n",
       "      <td>1351291779102990338</td>\n",
       "      <td>RT @PatricioAlarco2: Ahora resulta que Argenti...</td>\n",
       "      <td>&lt;a href=\"http://twitter.com/download/android\" ...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611008040582</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>146</th>\n",
       "      <td>1351291780940050449</td>\n",
       "      <td>1-e8a27d217039af2d8f38cadf47e0df80</td>\n",
       "      <td>Mon Jan 18 22:14:01 +0000 2021</td>\n",
       "      <td>1351291780940050449</td>\n",
       "      <td>1351291780940050449</td>\n",
       "      <td>RT @totocapitano: Estuve viendo el debate de l...</td>\n",
       "      <td>&lt;a href=\"http://twitter.com/download/iphone\" r...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611008041020</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>147</th>\n",
       "      <td>1351291785029562369</td>\n",
       "      <td>1-b1477ff510e7652c07bf0efedbab62cc</td>\n",
       "      <td>Mon Jan 18 22:14:01 +0000 2021</td>\n",
       "      <td>1351291785029562369</td>\n",
       "      <td>1351291785029562369</td>\n",
       "      <td>RT @CarlosVerareal: ¿Creen que $40 de multa po...</td>\n",
       "      <td>&lt;a href=\"http://twitter.com/download/android\" ...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611008041995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148</th>\n",
       "      <td>1351291789089640450</td>\n",
       "      <td>1-336a47a8a8117b923b4368bd7a59aba1</td>\n",
       "      <td>Mon Jan 18 22:14:02 +0000 2021</td>\n",
       "      <td>1351291789089640450</td>\n",
       "      <td>1351291789089640450</td>\n",
       "      <td>RT @ecuainm_oficial: ▶️#ATENCIÓN Gremios y Cám...</td>\n",
       "      <td>&lt;a href=\"http://twitter.com/download/android\" ...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611008042963</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>149</th>\n",
       "      <td>1351291792994562048</td>\n",
       "      <td>1-f594d29563662f5941e0cc13936f461f</td>\n",
       "      <td>Mon Jan 18 22:14:03 +0000 2021</td>\n",
       "      <td>1351291792994562048</td>\n",
       "      <td>1351291792994562048</td>\n",
       "      <td>Noooormaaaal pues</td>\n",
       "      <td>&lt;a href=\"http://twitter.com/download/android\" ...</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>es</td>\n",
       "      <td>1611008043894</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.351225e+18</td>\n",
       "      <td>1351225328975417351</td>\n",
       "      <td>{'created_at': 'Mon Jan 18 17:49:57 +0000 2021...</td>\n",
       "      <td>{'url': 'https://t.co/RfPOf9SZzT', 'expanded':...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>150 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     _id                                _rev  \\\n",
       "0    1351290781533876227  1-4138829b6443900e6e78db8e50b85706   \n",
       "1    1351290783903563777  1-c18c818a1189d2f834793b13d31404df   \n",
       "2    1351290784562225155  1-e67050c0001bf1a89559b88168ce4074   \n",
       "3    1351290788777349120  1-60e88d1a7759b584e8296ee13a8d2e8e   \n",
       "4    1351290803306508293  1-098a860688d58a118589ff6c6f1a7a7c   \n",
       "..                   ...                                 ...   \n",
       "145  1351291779102990338  1-d55070debfe85acb5d4eb036ea7cf4a1   \n",
       "146  1351291780940050449  1-e8a27d217039af2d8f38cadf47e0df80   \n",
       "147  1351291785029562369  1-b1477ff510e7652c07bf0efedbab62cc   \n",
       "148  1351291789089640450  1-336a47a8a8117b923b4368bd7a59aba1   \n",
       "149  1351291792994562048  1-f594d29563662f5941e0cc13936f461f   \n",
       "\n",
       "                         created_at                   id               id_str  \\\n",
       "0    Mon Jan 18 22:10:02 +0000 2021  1351290781533876227  1351290781533876227   \n",
       "1    Mon Jan 18 22:10:03 +0000 2021  1351290783903563777  1351290783903563777   \n",
       "2    Mon Jan 18 22:10:03 +0000 2021  1351290784562225155  1351290784562225155   \n",
       "3    Mon Jan 18 22:10:04 +0000 2021  1351290788777349120  1351290788777349120   \n",
       "4    Mon Jan 18 22:10:07 +0000 2021  1351290803306508293  1351290803306508293   \n",
       "..                              ...                  ...                  ...   \n",
       "145  Mon Jan 18 22:14:00 +0000 2021  1351291779102990338  1351291779102990338   \n",
       "146  Mon Jan 18 22:14:01 +0000 2021  1351291780940050449  1351291780940050449   \n",
       "147  Mon Jan 18 22:14:01 +0000 2021  1351291785029562369  1351291785029562369   \n",
       "148  Mon Jan 18 22:14:02 +0000 2021  1351291789089640450  1351291789089640450   \n",
       "149  Mon Jan 18 22:14:03 +0000 2021  1351291792994562048  1351291792994562048   \n",
       "\n",
       "                                                  text  \\\n",
       "0    RT @sybelmartinez: 13 niñas menores de 14 años...   \n",
       "1    RT @emersoncruuz: @cony_ruiz32 @luisevivanco E...   \n",
       "2    #Migración | Te contamos la historia de José A...   \n",
       "3    @Danilosaavedr1 @FaustoCoboM3 Según él, todo l...   \n",
       "4    RT @FerminVallejos1: Victoria de la patria gra...   \n",
       "..                                                 ...   \n",
       "145  RT @PatricioAlarco2: Ahora resulta que Argenti...   \n",
       "146  RT @totocapitano: Estuve viendo el debate de l...   \n",
       "147  RT @CarlosVerareal: ¿Creen que $40 de multa po...   \n",
       "148  RT @ecuainm_oficial: ▶️#ATENCIÓN Gremios y Cám...   \n",
       "149                                  Noooormaaaal pues   \n",
       "\n",
       "                                                source  truncated  \\\n",
       "0    <a href=\"http://twitter.com/download/android\" ...      False   \n",
       "1    <a href=\"http://ecuabot.org\" rel=\"nofollow\">Ec...      False   \n",
       "2    <a href=\"https://www.hootsuite.com\" rel=\"nofol...       True   \n",
       "3    <a href=\"https://about.twitter.com/products/tw...       True   \n",
       "4    <a href=\"http://twitter.com/download/android\" ...      False   \n",
       "..                                                 ...        ...   \n",
       "145  <a href=\"http://twitter.com/download/android\" ...      False   \n",
       "146  <a href=\"http://twitter.com/download/iphone\" r...      False   \n",
       "147  <a href=\"http://twitter.com/download/android\" ...      False   \n",
       "148  <a href=\"http://twitter.com/download/android\" ...      False   \n",
       "149  <a href=\"http://twitter.com/download/android\" ...      False   \n",
       "\n",
       "     in_reply_to_status_id in_reply_to_status_id_str  ...  lang  \\\n",
       "0                      NaN                      None  ...    es   \n",
       "1                      NaN                      None  ...    es   \n",
       "2                      NaN                      None  ...    es   \n",
       "3             1.351274e+18       1351273597076049920  ...    es   \n",
       "4                      NaN                      None  ...    es   \n",
       "..                     ...                       ...  ...   ...   \n",
       "145                    NaN                      None  ...    es   \n",
       "146                    NaN                      None  ...    es   \n",
       "147                    NaN                      None  ...    es   \n",
       "148                    NaN                      None  ...    es   \n",
       "149                    NaN                      None  ...    es   \n",
       "\n",
       "      timestamp_ms                                     extended_tweet  \\\n",
       "0    1611007802743                                                NaN   \n",
       "1    1611007803308                                                NaN   \n",
       "2    1611007803465  {'full_text': '#Migración | Te contamos la his...   \n",
       "3    1611007804470  {'full_text': '@Danilosaavedr1 @FaustoCoboM3 S...   \n",
       "4    1611007807934                                                NaN   \n",
       "..             ...                                                ...   \n",
       "145  1611008040582                                                NaN   \n",
       "146  1611008041020                                                NaN   \n",
       "147  1611008041995                                                NaN   \n",
       "148  1611008042963                                                NaN   \n",
       "149  1611008043894                                                NaN   \n",
       "\n",
       "    possibly_sensitive display_text_range quoted_status_id  \\\n",
       "0                  NaN                NaN              NaN   \n",
       "1                  NaN                NaN              NaN   \n",
       "2                False                NaN              NaN   \n",
       "3                  NaN          [30, 140]              NaN   \n",
       "4                  NaN                NaN              NaN   \n",
       "..                 ...                ...              ...   \n",
       "145                NaN                NaN              NaN   \n",
       "146                NaN                NaN              NaN   \n",
       "147                NaN                NaN              NaN   \n",
       "148                NaN                NaN              NaN   \n",
       "149                NaN                NaN     1.351225e+18   \n",
       "\n",
       "    quoted_status_id_str                                      quoted_status  \\\n",
       "0                    NaN                                                NaN   \n",
       "1                    NaN                                                NaN   \n",
       "2                    NaN                                                NaN   \n",
       "3                    NaN                                                NaN   \n",
       "4                    NaN                                                NaN   \n",
       "..                   ...                                                ...   \n",
       "145                  NaN                                                NaN   \n",
       "146                  NaN                                                NaN   \n",
       "147                  NaN                                                NaN   \n",
       "148                  NaN                                                NaN   \n",
       "149  1351225328975417351  {'created_at': 'Mon Jan 18 17:49:57 +0000 2021...   \n",
       "\n",
       "                               quoted_status_permalink  extended_entities  \n",
       "0                                                  NaN                NaN  \n",
       "1                                                  NaN                NaN  \n",
       "2                                                  NaN                NaN  \n",
       "3                                                  NaN                NaN  \n",
       "4                                                  NaN                NaN  \n",
       "..                                                 ...                ...  \n",
       "145                                                NaN                NaN  \n",
       "146                                                NaN                NaN  \n",
       "147                                                NaN                NaN  \n",
       "148                                                NaN                NaN  \n",
       "149  {'url': 'https://t.co/RfPOf9SZzT', 'expanded':...                NaN  \n",
       "\n",
       "[150 rows x 38 columns]"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfMA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "patient-hebrew",
   "metadata": {},
   "outputs": [],
   "source": [
    "dfMA.to_csv('elecciones2021.csv', index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "young-crown",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
